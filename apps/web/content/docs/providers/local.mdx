---
title: 'Local'
description: 'Test PayKit locally without external dependencies.'
date: '2025-08-02'
published: true
toc: true
---

The Local provider creates a complete payment simulation environment on your machine. Your backend logic lives in a single configurable file, and the development server provides a hosted checkout experience.

## Quick Start

Install the Local provider:

<br />

```bash
# terminal
npm install @paykit-sdk/local
```

## Setup

### Method 1: Environment Variables

<br />

```typescript
// lib/paykit.ts
import { PayKit } from '@paykit-sdk/core';
import { local } from '@paykit-sdk/local';

const provider = local(); // Ensure PAYKIT_API_URL, PAYKIT_PAYMENT_URL environment variables are set

const paykit = new PayKit(provider);

export { paykit };
```

### Method 2: Direct Configuration

<br />

```typescript
// lib/paykit.ts
import { PayKit } from '@paykit-sdk/core';
import { createLocal } from '@paykit-sdk/local';

const provider = createLocal({
  webhookUrl: 'http://localhost:3000/api/paykit',
  paymentUrl: 'http://localhost:4242',
});

const paykit = new PayKit(provider);

export { paykit };
```

## CLI Setup

Initialize PayKit in your project:

<br />

```bash
# terminal
npx @paykit-sdk/cli init
```

This creates a `.paykit/config.json` file where you'll define your payment logic.

Start the development server:

<br />

```bash
# terminal
npx @paykit-sdk/cli dev
```

The checkout interface will be available at `http://localhost:4242`.

## Configuration

Edit `.paykit/config.json` to define your payment flows:

<br />

```json
# .paykit/config.json
{
  "product": {
    "itemId": "it_YsojnrQDeFTuoKdVgtAqnbRolk-3nq",
    "name": "Paykit Pro License",
    "description": "Go unlimited!",
    "price": "$25"
  },
  "customer": {
    "id": "cus_hS3kLFq0U3e1l1H8haxV7-LqlnIsn0",
    "email": "em@paykit.com",
    "name": "Emmanuel Odii",
    "metadata": {}
  },
  "subscriptions": [],
  "checkouts": [],
  "invoices": []
}
```

## Basic Usage

<br />

```typescript
// api/checkouts/route.ts
import { paykit } from '@/lib/paykit';

export async function POST(request: Request) {
  const { customer_id, item_id, session_type, metadata } = await request.json();

  const [checkout, error] = await paykit.checkouts.create({
    customer_id,
    item_id,
    session_type,
    metadata,
  });

  if (error) return Response.json({ error: error.message }, { status: 400 });

  return Response.json(checkout);
}
```

## Webhook Setup

The Local provider uses plugins to handle webhooks differently from other providers.

### Next.js API Route

<br />

```typescript
// api/paykit/route.ts
import { paykit } from '@/lib/paykit';
import { withLocalWebhook } from '@paykit-sdk/local/plugins';
import { NextRequest, NextResponse } from 'next/server';

export async function POST(request: NextRequest) {
  console.log('POST request received');

  const webhook = paykit.webhooks
    .setup({ webhookSecret: process.env.PAYKIT_WEBHOOK_SECRET! })
    .on('$checkoutCreated', async event => {
      console.log('Checkout created:', event.data);
      // Handle checkout creation
    })
    .on('$customerCreated', async event => {
      console.log('Customer created:', event.data);
      // Handle customer creation
    })
    .on('$invoicePaid', async event => {
      console.log('Payment received:', event.data);
      // Handle successful payment
    });

  // remove this when you're switching to a production ready provider like stripe
  const response = await withLocalWebhook(request.nextUrl.toString(), webhook);

  return NextResponse.json(response);
}
```

### Vite.js

<br />

```typescript
// server/api/paykit.ts
import { paykit } from '@/lib/paykit';
import { withViteWebhook } from '@paykit-sdk/local/plugins';

export default defineEventHandler(async event => {
  const webhook = paykit.webhooks
    .setup({ webhookSecret: process.env.PAYKIT_WEBHOOK_SECRET! })
    .on('$checkoutCreated', async event => {
      console.log('Checkout created:', event.data);
    })
    .on('$customerCreated', async event => {
      console.log('Customer created:', event.data);
    })
    .on('$invoicePaid', async event => {
      console.log('Payment received:', event.data);
    });

  // remove this when you're switching to a production ready provider like stripe
  const result = await withViteWebhook(event, webhook);

  return result;
});
```

## Development Workflow

1. Run `npx @paykit-sdk/cli init` to create your config
2. Edit `.paykit/config.json` with your products, customers, and subscriptions
3. Start the dev server with `npx @paykit-sdk/cli dev`
4. Implement your API route using the plugin helpers
5. Test payment flows through the hosted checkout interface

## Environment Variables

<br />

```bash
# .env
PAYKIT_API_URL=http://localhost:3000/api/paykit
PAYKIT_PAYMENT_URL=http://localhost:4242
PAYKIT_WEBHOOK_SECRET=''
```

## Provider Metadata

Local provider supports basic configuration:

<br />

```typescript
const [checkout, error] = await paykit.checkouts.create({
  customer_id: 'cus_123',
  item_id: 'price_123',
  session_type: 'one_time',
  metadata: { plan: 'pro' },
  provider_metadata: {
    amount: 30, // Overrides the `amount` specified in config file
    currency: 'GBP', // Overrides the `currency` specified in config file
  },
});
```

## Support

- [PayKit Documentation](https://usepaykit.dev/docs/introduction)
