---
title: 'GoPay'
description: 'Integrate GoPay payments with PayKit.'
date: '2025-10-30'
published: true
toc: true
---

PayKit provides seamless GoPay integration with a unified API that works across all payment providers.

## Quick Start

Install the GoPay provider:

<br />

```bash
# terminal
npm install @paykit-sdk/gopay
```

## Setup

### Method 1: Environment Variables

<br />

```typescript
// lib/paykit.ts
import { PayKit, createEndpointHandlers } from '@paykit-sdk/core';
import { gopay } from '@paykit-sdk/gopay';

const provider = gopay(); // Ensure required environment variables are set
const paykit = new PayKit(provider);
const endpoints = createEndpointHandlers(paykit);

export { paykit, endpoints };
```

### Method 2: Direct Configuration

<br />

```typescript
// lib/paykit.ts
import { PayKit, createEndpointHandlers } from '@paykit-sdk/core';
import { createGopay } from '@paykit-sdk/gopay';

const provider = createGopay({
  clientId: '140...',
  clientSecret: 'n6W...',
  goId: '864....',
  isSandbox: true,
  webhookUrl: 'https://your-domain.com/api/paykit/webhooks',
  debug: true,
});

const paykit = new PayKit(provider);
const endpoints = createEndpointHandlers(paykit);

export { paykit, endpoints };
```

## Basic Usage

<br />

Next.js catchâ€‘all route. This forwards calls to the generated handlers.

<br />

```typescript
// app/api/paykit/[...endpoint]/route.ts
import { endpoints } from '@/lib/paykit';
import type { EndpointArgs, EndpointHandler, EndpointPath } from '@paykit-sdk/core';
import { NextResponse, NextRequest } from 'next/server';

export async function POST(
  request: NextRequest,
  { params }: { params: Promise<{ endpoint: string[] }> },
) {
  const { endpoint: endpointArray } = await params;
  const endpoint = ('/' + endpointArray.join('/')) as EndpointPath;
  const handler = endpoints[endpoint] as EndpointHandler<typeof endpoint>;

  if (!handler) {
    return NextResponse.json({ message: 'Endpoint not found' }, { status: 404 });
  }

  const body = await request.json();
  const { args } = body as { args: EndpointArgs<typeof endpoint> };
  try {
    const result = await handler(...args);
    return NextResponse.json({ result });
  } catch (error) {
    return NextResponse.json(
      { message: error instanceof Error ? error.message : 'Internal server error' },
      { status: 500 },
    );
  }
}
```

## Webhook Setup

<Callout type="warning">
  **Important:** GoPay webhooks use GET requests instead of POST. Your webhook route must
  export a GET handler, not POST.
</Callout>

Configure your webhook URL in the GoPay dashboard to point to your webhook endpoint. GoPay will send GET requests with payment IDs as query parameters.

<br />

Webhook route. This validates and dispatches events.

<br />

```typescript
// app/api/paykit/webhooks/route.ts
import { paykit } from '@/lib/paykit';
import type { NextRequest } from 'next/server';
import { NextResponse } from 'next/server';

export async function GET(request: NextRequest) {
  const webhook = paykit.webhooks
    .setup({ webhookSecret: '' }) // GoPay doesn't use webhook secrets
    .on('customer.created', async event => {})
    .on('subscription.created', async event => {})
    .on('payment.created', async event => {})
    .on('refund.created', async event => {})
    .on('invoice.generated', async event => {});

  const headers = request.headers;
  const url = request.url;

  try {
    await webhook.handle({ body: '', headers, fullUrl: url });
    console.log('Webhook handled');
    return NextResponse.json({ success: true });
  } catch (error) {
    console.error('Webhook error:', error);
    return NextResponse.json({ success: false }, { status: 500 });
  }
}
```

## Environment Variables

<br />

```bash
# .env
GOPAY_CLIENT_ID=140...
GOPAY_CLIENT_SECRET=n6W...
GOPAY_GO_ID=864....
GOPAY_SANDBOX=true
GOPAY_WEBHOOK_URL=https://your-domain.com/api/paykit/webhooks
```

**ðŸ’¡** When using environment variables with `createGopay()`, make sure to set `debug: true` in your provider configuration (see Method 1 above) to receive helpful logs about recommended `provider_metadata` fields.

## Provider Metadata

GoPay supports additional configuration through `provider_metadata`:

<br />

```typescript
const checkout = await paykit.checkouts.create({
  customer: { email: 'user@example.com' },
  item_id: 'item_123', // item_id can be the name of your product from eShop
  session_type: 'one_time',
  quantity: 1,
  metadata: { plan: 'pro' },
  success_url: 'http://localhost:3000/success',
  cancel_url: 'http://localhost:3000/cancel',
  provider_metadata: {
    amount: '2900',
    currency: 'CZK',
    lang: 'en', // Language for the payment gateway (default: 'EN')
  },
});
```

## Example checkout

<br />

```typescript
const checkout = await paykit.checkouts.create({
  customer: { email: 'user@example.com' },
  item_id: 'item_123', // item_id can be the name of your product from eShop
  session_type: 'one_time',
  quantity: 1,
  metadata: { plan: 'pro' },
  success_url: 'http://localhost:3000/success',
  cancel_url: 'http://localhost:3000/cancel',
  provider_metadata: {
    amount: '2900',
    currency: 'CZK',
  },
});
```

## Support

- [GoPay Documentation](https://doc.gopay.com/)
- [PayKit Issues](https://github.com/usepaykit/paykit-sdk/issues)
