---
title: 'Hono'
description: 'Install and configure PayKit for Hono backends.'
date: '2025-10-30'
published: true
toc: true
---

## Install with shadcn

Add the Hono block:

<br />

```bash
npx shadcn@latest add https://usepaykit.dev/r/stripe-hono
```

## Manual setup

Create a provider entry and export PayKit and endpoints:

<br />

```ts
// src/lib/paykit.ts
import { PayKit, createEndpointHandlers } from '@paykit-sdk/core';
import { stripe } from '@paykit-sdk/stripe';

export const paykit = new PayKit(stripe());
export const endpoints = createEndpointHandlers(paykit);
```

Create a Hono router that mounts PayKit routes:

<br />

```ts
// src/routes/paykit.ts
import { endpoints } from '@/lib/paykit';
import { EndpointHandler } from '@paykit-sdk/core';
import { Hono } from 'hono';

const app = new Hono();

app.post('/paykit/*', async c => {
  const path = c.req.path.replace('/paykit', '') as keyof typeof endpoints;

  const handler = endpoints[path] as EndpointHandler<typeof path>;

  if (!handler) {
    return c.json({ message: 'Endpoint not found' }, 404);
  }

  const body = await c.req.json();
  const { args } = body as { args: EndpointArgs<typeof path> };

  try {
    const result = await handler(...args);
    return c.json({ result });
  } catch (error) {
    console.error('PayKit API Error:', error);
    return c.json({ message: 'Internal server error' }, 500);
  }
});

export default app;
```

## Webhook

<br />

```ts
// src/routes/webhook.ts
import { Hono } from 'hono';
import { paykit } from '../lib/paykit';

const webhook = new Hono();

webhook.post('/webhook', async c => {
  const secret = c.env?.STRIPE_WEBHOOK_SECRET;

  if (!secret) {
    return c.json({ error: 'Webhook secret not configured' }, 500);
  }

  const w = paykit.webhooks
    .setup({ webhookSecret: secret })
    .on('customer.created', async event => {
      console.log('Customer created:', event.data);
    })
    .on('subscription.created', async event => {
      console.log('Subscription created:', event.data);
    })
    .on('payment.created', async event => {
      console.log('Payment created:', event.data);
    })
    .on('refund.created', async event => {
      console.log('Refund created:', event.data);
    })
    .on('invoice.generated', async event => {
      console.log('Invoice generated:', event.data);
    });

  const body = await c.req.text();
  const headers = c.req.raw.headers;
  const url = new URL(c.req.url).toString();

  try {
    await w.handle({ body, headers, fullUrl: url });
    console.log('Webhook handled');
    return c.json({ success: true });
  } catch {
    console.error('Webhook error:', error);
    return c.json({ success: false });
  }
});

export default webhook;
```

## Environment variables

<br />

```bash
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
```
