---
title: 'Error Handling'
description: 'Learn how to handle errors in PayKit.'
date: '2025-08-02'
published: true
toc: true
---

PayKit uses a consistent error handling pattern across all operations. Every method returns a tuple `[data, error]` that you can destructure to handle both success and error cases.

## Basic Pattern

All PayKit methods return `[data, error]`:

<br />

```typescript
const [data, error] = await paykit.resource.method(params);

if (error) {
  // Handle error
  console.error('Error:', error.message);
  return;
}

// Use data
console.log('Success:', data);
```

## Customer Examples

<br />

```typescript
// Create customer
const [customer, error] = await paykit.customers.create({
  email: 'user@example.com',
  name: 'John Doe',
});

if (error) {
  console.error('Failed to create customer:', error.message);
  return;
}

console.log('Customer created:', customer.id);

// Retrieve customer
const [customer, error] = await paykit.customers.retrieve('cus_123');

if (error) {
  console.error('Failed to retrieve customer:', error.message);
  return;
}

console.log('Customer found:', customer.email);
```

## Checkout Examples

<br />

```typescript
// Create checkout
const [checkout, error] = await paykit.checkouts.create({
  customer_id: 'cus_123',
  item_id: 'price_123',
  session_type: 'one_time',
  metadata: { lifeTimeAccess: 'true' },
});

if (error) {
  console.error('Failed to create checkout:', error.message);
  return;
}

console.log('Checkout URL:', checkout.payment_url);

// Retrieve checkout
const [checkout, error] = await paykit.checkouts.retrieve('cs_123');

if (error) {
  console.error('Failed to retrieve checkout:', error.message);
  return;
}

console.log('Checkout status:', checkout.session_type);
```

## Subscription Examples

<br />

```typescript
// Create subscription
const [subscription, error] = await paykit.subscriptions.create({
  customer_id: 'cus_123',
  item_id: 'price_123',
  metadata: { plan: 'pro' },
});

if (error) {
  console.error('Failed to create subscription:', error.message);
  return;
}

console.log('Subscription created:', subscription.id);

// Cancel subscription
const [subscription, error] = await paykit.subscriptions.cancel('sub_123');

if (error) {
  console.error('Failed to cancel subscription:', error.message);
  return;
}

console.log('Subscription cancelled:', subscription.status);
```

## Client-Side React Example

<br />

```typescript
// components/checkout-form.tsx
import * as React from 'react';
import { useCheckout } from '@paykit-sdk/react';

export function CheckoutForm() {
  const { create } = useCheckout();
  const [error, setError] = useState<string | null>(null);

  const handleCheckout = async () => {
    setError(null);

    const [checkout, error] = await create.run({
      customer_id: 'cus_123',
      item_id: 'price_123',
      session_type: 'one_time',
      metadata: { lifeTimeAccess: 'true' },
    });

    if (error) {
      setError(error.message);
      return;
    }

    // Redirect to payment page
    window.location.href = checkout.payment_url;
  };

  return (
    <div>
      <button onClick={handleCheckout} disabled={isLoading}>
        {create.loading ? 'Creating checkout...' : 'Pay Now'}
      </button>

      {error && <p className="text-red-500"> Error: {error} </p>}
    </div>
  );
}
```

## API Route Example

<br />

```typescript
// api/customers/route.ts
import { paykit } from '@/lib/paykit';

export async function POST(request: Request) {
  const { email, name } = await request.json();

  const [customer, error] = await paykit.customers.create({
    email,
    name,
  });

  if (error) {
    return Response.json({ error: error.message }, { status: 400 });
  }

  return Response.json(customer);
}
```
